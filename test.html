<!-- index.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TreeWalker with Custom Elements and Slots</title>
</head>
<body>
  <div id="container">
    <custom-element>
      <div slot="item">Slotted Item</div>
    </custom-element>
  </div>

  <script>


// main.js
class CustomElement extends HTMLElement {
  constructor() {
    super();
    const shadowRoot = this.attachShadow({ mode: 'open' });
    shadowRoot.innerHTML = `
      <div class="shadow-item">Shadow Item 1</div>
      <div class="shadow-item">Shadow Item 2</div>
      <slot name="item"></slot>
      <nested-custom-element></nested-custom-element>
    `;
  }
}

class NestedCustomElement extends HTMLElement {
  constructor() {
    super();
    const shadowRoot = this.attachShadow({ mode: 'open' });
    shadowRoot.innerHTML = `
      <div class="nested-shadow-item">Nested Shadow Item</div>
    `;
  }
}

customElements.define('custom-element', CustomElement);
customElements.define('nested-custom-element', NestedCustomElement);

function processNode(node) {
  if (node instanceof HTMLElement && node.tagName.toLowerCase().startsWith('custom-')) {
    node.classList.add('dark');
  }
}

function walkDOM(rootNode) {
  const treeWalker = document.createTreeWalker(
    rootNode,
    NodeFilter.SHOW_ELEMENT,
    null,
    false
  );

  while (treeWalker.nextNode()) {
    const node = treeWalker.currentNode;
    processNode(node);

    // Check if the node has a shadow root
    if (node.shadowRoot) {
      walkDOM(node.shadowRoot);
    }

    // Check if the node has assigned nodes (for slots)
    if (node.assignedNodes) {
      node.assignedNodes().forEach(assignedNode => {
        if (assignedNode.nodeType === Node.ELEMENT_NODE) {
          walkDOM(assignedNode);
        }
      });
    }
  }
}

walkDOM(document.getElementById('container'));
  </script>
</body>
</html>